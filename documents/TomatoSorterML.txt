Hi, it's John Williams here from MIT. So I wanted to take a look at MATLAB's machine learning and apply it to tomatoes. So these are actually Taiwanese tomatoes. And I pulled them off the web. And they're various kinds of Taiwanese tomatoes. My goal is to see if I can distinguish good tomatoes-- so all these, I think, are good tomatoes-- from bad tomatoes. So some of these are misshapen. Some have been frost damaged or got some disease. And so the first thing that I need to do is to resize all these images. So I copied all these images into a file. So let me show you here. So for example, these are the good images-- sorry, the good tomatoes. But they're all different sized files. This one's 300 and something, this 600. And I didn't quite get the dimensions right. And here's my bad tomatoes. I got less of those, 13 of those. And I've got some 19 of these. So I don't expect to do too well because I've only just got a few images here. But I just wanted to go through the motions. So the first thing I've got to do is be able to pick these up and resize them. I have some code that I developed. And let's take a look at it. Here we are. To resize all the images, I'm going to pick up the folder. And this will pick up and form metadata about all of these images. And then I'm going to loop over all these files. And basically, it stores the folder name and then the name of the source file. So here, the file name is the folder name. I need to put a slash in there to concatenate. And then the name of the file. So I'm reading in the files with IAMREAD. Now resize each of those to 300 by 300. And then I'm picking a new file name. And what I'm doing is just putting an A on the name of the folder. So instead of TB, it's going to be TBA. And instead of TG for tomato good, it's going to be TGA. And I need to set up those folders. But then I can just write the new file to those. And if I look at the files-- let's have a look. I think I've got them here again. So those are the original ones. And then under-- I put under directory here these new files. And these are 300 by 300. And so those are obviously the bad ones. And if we look here at the good ones, we'll see that. Now I should normalize these and rotate them and do all kinds of things that will help the algorithm. But I decide not to. Right, let's take a look at MATLAB. And basically what we're going to do here, I'm going to read in-- so this was done for some faces. I should put tomato base. But I get all the images under tomato images. So now I've got two sets, one called TGA and one called TBA. And now I'm going to split both of those into a training and test with a proportion of 80% to be training and 20% for test. Now I'm going to do-- basically get some different features here, extract the features, and then I'm going to do my training. So feature count. And now I'm going to loop over the size of the training set. And these will be the training features. And I'm going to use extract hog features for those. So those will be the training features. And the training labels are just the good and the bad. And I'm just using the file names there. TGA and TBA. And that'll be the description here. And now we build a classifier based on those training features. So that was just the hog features, which are kind of basically picking out the gradients in the images. So it's a fairly crude classifier. I'm not doing neural nets or anything like that. But now I've got a classifier, and I can test it, for example, with a query image. So here's an image that I haven't seen. So I'm picking it out of the test ones now rather than the training ones. And then we ask the predictor that we've got here-- I'm picking out the query features here, sorry, using the hog on the query image-- and then passing that to the classifier. And it'll give me a label for it, whether it's a good or bad tomato. So that's basically it. So it performs at about 60% or 70% level, which is not that great, but considering the few images that I've got, that's not bad. And it took about an hour for me to hack through this. Resizing the images was probably one of the major issues. OK, so let's take a look at this tomato sorting machine. And they only want the red ones. And you can see this machine is just flicking out the green ones. This is in slow motion, which is very impressive. So you'll see. And full speed again. OK, that's all for now. That's pretty good. Thanks. [SIDE CONVERSATION]